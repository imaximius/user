!function(){"use strict";angular.module("admin.user",["ngStorage","ngDialog"])}(),function(n){"use strict";function e(n){n.defaults.headers.common["X-Requested-With"]="XMLHttpRequest"}n.module("admin.user").config(["$httpProvider",e])}(angular),function(n){"use strict";function e(n,e){!function(n){function o(){n.form.$valid&&(n.inLoading=!0,e.login({username:n.username,password:n.password,remember:n.remember,onSuccess:t,onError:i}))}function t(){n.inLoading=!1}function i(e){n.inLoading=!1,n.error=e.response.error||"FOSUserBundle.Bad credentials",n.form.username.$dirty=!0,n.form.password.$dirty=!0}n.inLoading=!1,n.submitDisabled=!0,n.username="",n.password="",n.remember=!1,n.error="",n.submit=o,e.initLoginForm(function(){n.submitDisabled=!1})}(n)}n.module("admin.user").controller("LoginController",["$scope","UserAuth",e])}(angular),function(n){"use strict";function e(e,o,t){!function(e){function i(){e.profile.$invalid||(e.inLoading=!0,n.forEach(c,function(n,o){var t=e[o];"undefined"==typeof t&&(t=n.value),this[n.name]=t},s={}),o.post("/manage/profile/edit",$.param(s),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(a).error(u))}function r(){e.closeThisDialog()}function a(o){e.inLoading=!1,n.forEach(o,function(n,e){"fullName"==e&&(e="name"),t[e]=n}),r()}function u(n){e.inLoading=!1,e.errors=n.errors}var s,c={};e.inLoading=!0,e.isSubmitDisabled=!0,e.errors=[],e.username="",e.fullName="",e.email="",e.save=i,e.close=r,o.get("/manage/profile/edit").success(function(o){n.forEach(o.form,function(n){this[n.name]={name:n.full_name,value:n.value},$.inArray(n.name,["username","fullName","email"])>=0&&(e[n.name]=n.value)},c),e.inLoading=e.isSubmitDisabled=!1})}(e)}n.module("admin.user").controller("ProfileEditController",["$scope","$http","User",e])}(angular),function(n){"use strict";function e(n,e,o,t,i,r){!function(e){function a(){o.open({template:r.basepath("ngdialog/profile.html"),controller:"ProfileEditController"})}function u(){e.inLoading=!0,i.logout({onSuccess:function(){e.inLoading=!1}})}e.inLoading=!1,e.user=t,e.editProfile=a,e.logout=u,n.toggleUserBlock=function(){n.$broadcast("toggleUserBlock")},n.userBlockVisible=!0}(e)}n.module("admin.user").controller("ProfileController",["$rootScope","$scope","ngDialog","User","UserAuth","RouteHelpers",e])}(angular),function(n){"use strict";function e(e,o,t){!function(n){n.inLoading=!1,n.error="",n.username="",n.maskedEmail="",n.view={request:!0,checkMail:!1,reset:!1},"undefined"!=typeof t.token&&(n.view.request=!1,n.view.reset=!0)}(this),function(n){function o(){var o=n.request;n.error="",o.$valid?(n.inLoading=!0,e.post("/resetting/send-email",{username:n.username}).then(function(e){n.inLoading=!1,n.view.request=!1,n.view.checkMail=!0,n.maskedEmail=e.data.email},function(e){n.inLoading=!1,n.error=e.data.error})):o.username.$dirty=!0}n.sendEmailAction=o}(this),function(i){function r(){i.inLoading=!0,e.post(u).success(function(e){n.forEach(e,function(e){return"_token"==e.name?void(s=e):void(this[e.name]=n.extend(this[e.name],e))},c),i.inLoading=!1}).error(function(n){i.inLoading=!1,i.showForm=!1})}function a(){var t={};i.inLoading=!0,n.forEach(c,function(n){this[n.full_name]=n.ng},t),t[s.full_name]=s.value,e.post(u,$.param(t),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n,e){return 202!=e?void(i.inLoading=!1):void o.go("login")}).error(function(n){i.inLoading=!1,i.error=n.error})}var u="/resetting/reset/"+t.token,s={},c={first:{label:"form.new_password",name:"",full_name:"",ng:"",value:""},second:{label:"form.new_password_confirmation",name:"",full_name:"",ng:"",value:""}};i.fosUi=c,i.showForm=!0,i.onViewLoaded=r,i.resetAction=a}(this)}n.module("admin.user").controller("ResettingController",e),e.$inject=["$http","$state","$stateParams"]}(angular),function(){"use strict";function n(n,e){function o(){n.init(function(n){for(var e in n.settings)i.layout[e]=n.settings[e]}),e=n.settings}function t(e){"INPUT"==$(e.target).prop("tagName")&&n.setSettings(i.layout)}var i=this;i.layout=e,i.changeLayout=t,o()}angular.module("admin.user").controller("UserSettingsController",n),n.$inject=["User","layout"]}(),function(){"use strict";function n(n,e,o){function t(t){n.get("/master/login").success(function(n){u=n,"function"==typeof t&&t(n)}).error(function(n,t){403!=t&&401!=t||(e.setData($.extend(n,{authorized:!0})),o.go(s.name))})}function i(t){n.post("/master/login_check",$.param({_username:t.username,_password:t.password,_remember_me:t.remember,_csrf_token:u}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(n){var i=a(n);"function"==typeof t.onSuccess&&t.onSuccess(i),i.isPropagationStopped()||(e.setData(angular.extend(n,{authorized:!0})),o.go(s.name))}).error(function(n){var e=a(n);"function"==typeof t.onError&&t.onError(e),e.isPropagationStopped()||(u=n)})}function r(t){n.get("/manage/logout").success(function(n){var i=a(n);"object"==typeof t&&"function"==typeof t.onSuccess&&t.onSuccess(i),i.isPropagationStopped()||(e.setAsNotAuthorized(),o.go("login"))}).error(function(n){var e=a(n);"object"==typeof t&&"function"==typeof t.onError&&t.onError(e)})}function a(n){function e(){t=!0}function o(){return t}var t=!1;return{response:n,isPropagationStopped:o,stopPropagation:e}}var u,s={name:"app.users"};return{initLoginForm:t,login:i,logout:r}}angular.module("admin.user").service("UserAuth",["$http","User","$state",n])}(),function(){"use strict";function n(n){function e(e){u.pending||(u.pending=!0,n(u.resource).then(function(n){u.pending=!1,a(n.data),"function"==typeof e&&e(s)},function(){u.pending=!1}))}function o(){return s.settings}function t(e,o,t){n.post("/manage/profile/settings",e).success(function(n){s.settings=e,"function"==typeof o&&o(n)}).error(function(n){"function"==typeof t&&t(n)})}function i(){s.authorized=!1}function r(){return s.authorized}function a(n){["name","email","settings","authorized","picture"].forEach(function(e){"undefined"!=typeof n[e]&&(s[e]=n[e])})}var u={resource:{method:"GET",url:"/master/user/data"},pending:!1},s={name:"",email:"",picture:"/public/admin/build/img/user/no-image.jpg",settings:{},authorized:!1,init:e,setSettings:t,getSettings:o,setAsNotAuthorized:i,isAuthorized:r,setData:a};return s}angular.module("admin.user").factory("User",n),n.$inject=["$http"]}(),function(){"use strict";angular.module("admin.user").directive("compareWith",function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(n,e,o,t){var i=function(){var e=n.$eval(o.ngModel),t=n.$eval(o.compareWith);return e==t};n.$watch(i,function(n){t.$setValidity("match",n)})}}})}();